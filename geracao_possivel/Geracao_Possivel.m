clc;
clear all;
close all;
graphics_toolkit fltk;
pkg load control
pkg load symbolic
pkg load signal

%Vetor da Vazao Afluente

Q=[17.30 , 17.32 , 17.27 , 12.21 , 9.99 , 12.41 , 14.00 , 16.43 , 11.16 , 13.64 , 13.58 , 15.69 , 16.62 , 16.65 , 14.21 , 13.59 , 13.50 , 14.10 , 14.50 , 14.50 , 14.64 , 14.55 , 14.61 , 14.54 , 14.87 , 14.87 , 14.48 , 12.86 , 12.48 , 12.48 , 13.16 , 12.55 , 12.48 , 13.16 , 13.61 , 13.67 , 13.68 , 12.62 , 12.48 , 13.14 , 13.21 , 14.17 , 13.83 , 13.81 , 12.26 , 11.70 , 11.47 , 11.19 , 11.47 , 11.81 , 11.77 , 13.17 , 14.51 , 5.34 , 8.48 , 15.83 , 15.04 , 17.89 , 20.18 , 18.87 , 18.09 , 13.31 , 10.47 , 11.57 , 11.73 , 11.83 , 11.82 , 11.80 , 13.02 , 14.62 , 13.58 , 10.90 , 10.01 , 10.98 , 11.22 , 14.13 , 15.16 , 14.51 , 10.27 , 4.70 , 2.93 , 2.64 , 2.57 , 1.98 , 1.97 , 1.76 , 1.10 , 0.86 , 0.74 , 0.73 , 0.74 , 0.75 , 0.65 , 0.61 , 0.63 , 0.63 , 0.73 , 0.68 , 6.52 , 6.89 , 6.86 , 6.84 , 6.86 , 6.86 , 6.87 , 6.86 , 6.87 , 6.92 , 6.87 , 6.98 , 6.99 , 6.94 , 6.94 , 6.83 , 6.23 , 5.99 , 6.21 , 6.84 , 6.68 , 5.08 , 3.11 , 0.56 , 3.80 , 5.19 , 7.43 , 11.77 , 13.22 , 13.21 , 13.19 , 13.19 , 13.90 , 16.42 , 16.89 , 14.90 , 14.12 , 14.67 , 14.59 , 13.30 , 10.43 , 9.78 , 8.47 , 13.21 , 13.21 , 13.19 , 11.74 , 9.93 , 9.79 , 9.78 , 8.04 , 10.44 , 12.56 , 12.47 , 12.36 , 12.64 , 12.83 , 12.76 , 12.86 , 13.17 , 12.81 , 13.16 , 13.18 , 13.17 , 13.17 , 12.07 , 10.95 , 11.16 , 10.36 , 9.97 , 8.31 , 6.02 , 6.54 , 7.17 , 5.67 , 8.71 , 11.74 , 13.88 , 17.69 , 18.87 , 19.60 , 19.08 , 17.42 , 17.03 , 17.01 , 17.44 , 17.66 , 17.95 , 18.24 , 18.62 , 18.65 , 18.64 , 18.59 , 18.54 , 18.67 , 18.69 , 18.21 , 15.54 , 17.75 , 18.17 , 11.58 , 5.09 , 5.59 , 24.64 , 27.07 , 22.82 , 20.84 , 19.84 , 18.77 , 17.76 , 16.16 , 15.29 , 15.26 , 15.23 , 15.20 , 15.17 , 15.14 , 15.11 , 15.08 , 15.05 , 15.02 , 14.99 , 14.96 , 14.94 , 14.91 , 14.88 , 14.85 , 14.82 , 14.79 , 14.76 , 14.73 , 14.70 , 14.67 , 14.64 , 14.61 , 14.58 , 14.22 , 13.87 , 13.81 , 13.39 , 13.29 , 13.31 , 13.32 , 13.32 , 13.38 , 13.29 , 13.25 , 13.31 , 13.36 , 13.35 , 13.36 , 13.30 , 14.64 , 15.50 , 15.14 , 14.76 , 14.69 , 14.42 , 13.95 , 13.87 , 13.84 , 16.07 , 17.76 , 18.00 , 18.49 , 18.79 , 18.81 , 18.81 , 19.18 , 20.80 , 15.30 , 14.97 , 24.08 , 29.57 , 27.26 , 26.48 , 26.50 , 26.49 , 26.49 , 26.48 , 27.07 , 27.18 , 27.17 , 27.16 , 27.14 , 27.11 , 26.98 , 26.54 , 26.48 , 26.47 , 26.15 , 25.81 , 25.37 , 24.56 , 24.04 , 23.44 , 24.46 , 23.84 , 24.15 , 23.95 , 23.39 , 22.78 , 23.50 , 23.34 , 23.16 , 22.98 , 22.63 , 22.69 , 22.58841302 , 22.48631732 , 22.38422162 , 22.28212593 , 22.18003023 , 22.07793453 , 21.97583883 , 21.87374313 , 21.77164743 , 21.66955174 , 21.56745604 , 21.46536034 , 21.36326464 , 21.26116894 , 21.15907324 , 21.05697755 , 20.95488185 , 20.85278615 , 20.75069045 , 20.64859475 , 20.54649905 , 20.44440336 , 20.34230766 , 20.24 , 20.24 , 20.05 , 19.88 , 19.85 , 19.78 , 19.64 , 19.08 , 18.42 , 20.26 , 17.21 , 20.26 , 21.40 , 17.73 , 22.93 , 30.67 , 27.57 , 26.42 , 25.88 , 27.60 , 28.00 , 28.65 , 29.31 , 29.47 , 29.83 , 30.00 , 29.84 , 28.89 , 37.96 , 42.24 , 44.49 , 36.59 , 35.33 , 59.15 , 51.53 , 47.04 , 46.64 , 46.00 , 46.30 , 45.09 , 48.47 , 44.40 , 50.88 , 45.91 , 45.33 , 45.27 , 44.43 , 44.38 , 43.43 , 42.62 , 41.61 , 44.04 , 43.77 , 42.60 , 41.97 , 41.26 , 40.40 , 40.54 , 41.21 , 39.70 , 38.86 , 38.14 , 38.08 , 37.48 , 37.46 , 40.42 , 38.20 , 37.52 , 37.22 , 36.11141861 , 35.00081062 , 33.89020263 , 32.77959465 , 31.66898666 , 30.55837867 , 29.44777069 , 28.3371627 , 27.22655471 , 26.11594673 , 25.00533874 , 23.89473075 , 22.78412277 , 21.67351478 , 20.56290679 , 19.45229881 , 18.34169082 , 17.23108283 , 16.12 , 27.14 , 20.98 , 20.94 , 26.16 , 24.89 , 24.53 , 24.46 , 24.46 , 25.83 , 31.31 , 30.78 , 29.83 , 19.12 , 20.23 , 28.90 , 29.64 , 40.15 , 40.38 , 31.95 , 28.31 , 21.71 , 24.48 , 28.72 , 29.38 , 29.06 , 36.73 , 29.87 , 27.41 , 30.10 , 29.16 , 28.40 , 27.48 , 24.07 , 28.04 , 29.63 , 27.33 , 23.87 , 28.07 , 28.08 , 27.26 , 27.68 , 28.80 , 27.00 , 22.00 , 28.65 , 27.51 , 26.31 , 24.06 , 27.21 , 26.07 , 24.44 , 27.49 , 27.92 , 26.63 , 25.84 , 25.78 , 25.81 , 25.73362724 , 25.6539728 , 25.57431837 , 25.49466394 , 25.41500951 , 25.33535507 , 25.25570064 , 25.17604621 , 25.09639177 , 25.01673734 , 24.93708291 , 24.85742848 , 24.77777404 , 24.69811961 , 24.61846518 , 24.53881074 , 24.45915631 , 24.37950188 , 24.29984745 , 24.22019301 , 24.14053858 , 24.06088415 , 23.98122971 , 23.90157528 , 23.82192085 , 23.74226642 , 23.66261198 , 23.58295755 , 23.50330312 , 23.42364868 , 23.34399425 , 23.26433982 , 23.18468539 , 23.10503095 , 23.02537652 , 22.94572209 , 22.86606765 , 22.78641322 , 22.70675879 , 22.62710436 , 22.54744992 , 22.46779549 , 22.38814106 , 22.30848662 , 22.22883219 , 22.14917776 , 22.06952333 , 22.07 , 22.07 , 22.07 , 22.05 , 22.06 , 22.04 , 21.96 , 20.93 , 9.47 , 17.26 , 20.41 , 19.73 , 19.24 , 19.06 , 22.34 , 23.10 , 20.87 , 18.26 , 20.28 , 21.51 , 20.48 , 19.72 , 19.58 , 19.02 , 18.90 , 18.90 , 18.89 , 18.81 , 18.50 , 17.24 , 17.07 , 17.68 , 19.69 , 21.87 , 22.01 , 18.73 , 16.43 , 13.42 , 8.28 , 31.20 , 28.27 , 26.60 , 20.34 , 15.95 , 16.73 , 17.69 , 18.44 , 18.61 , 18.81 , 19.24 , 19.23 , 19.02 , 19.04 , 18.90 , 18.80 , 18.80 , 18.89 , 19.15 , 18.78 , 18.79 , 18.75 , 18.46 , 18.29 , 18.23 , 18.53 , 18.71 , 18.95 , 19.12 , 19.38 , 19.62 , 19.69 , 19.67 , 19.38 , 19.18 , 18.91 , 18.80 , 18.84 , 18.77 , 19.01 , 19.10 , 19.42 , 19.18 , 19.15 , 19.65 , 20.16 , 19.61 , 16.43 , 22.83 , 20.12 , 19.15 , 11.33 , 9.33 , 9.36 , 22.21 , 36.61 , 31.18 , 27.02 , 21.94 , 25.89 , 34.67 , 49.88 , 48.43 , 54.94 , 54.36 , 54.37 , 53.82 , 65.80 , 56.42 , 52.83 , 55.06 , 54.11 , 53.34 , 51.97 , 50.90 , 50.27 , 49.49 , 49.27 , 47.23 , 48.62 , 47.71 , 46.57 , 45.68 , 44.94 , 44.31 , 43.37 , 42.39 , 41.59 , 41.44 , 40.81 , 40.49 , 34.99 , 40.96 , 37.77 , 36.44 , 35.92 , 35.50 , 34.57 , 33.74 , 32.05 , 35.72 , 33.28 , 32.91 , 32.39 , 32.30 , 32.28 , 32.06965655 , 31.85925191 , 31.64884728 , 31.43844265 , 31.22803801 , 31.01763338 , 30.80722874 , 30.59682411 , 30.38641948 , 30.17601484 , 29.96561021 , 29.75520557 , 29.54480094 , 29.33439631 , 29.12399167 , 28.91358704 , 28.7031824 , 28.49277777 , 28.28237314 , 28.0719685 , 27.86156387 , 27.65115924 , 27.4407546 , 27.44 , 27.62 , 27.61 , 27.75 , 27.57 , 27.31 , 24.36 , 25.20 , 29.47 , 28.75 , 24.49 , 28.46 , 23.76 , 21.07 , 33.51 , 29.24 , 26.68 , 25.76 , 25.86 , 25.91 , 25.82 , 25.81 , 25.79 , 25.80 , 25.77 , 25.66 , 25.35 , 25.24 , 25.20 , 25.16 , 25.16 , 25.13 , 25.14 , 24.86 , 24.48 , 24.94 , 22.53 , 25.50 , 25.97 , 25.18 , 24.44 , 23.72 , 23.04 , 24.52 , 23.63 , 24.00 , 24.21 , 24.13 , 23.87 , 23.85 , 23.81 , 23.78 , 23.57 , 18.58 , 24.13 , 23.00 , 24.48 , 22.10 , 25.87 , 23.94 , 21.19 , 21.14 , 20.41 , 26.20 , 24.71 , 23.03 , 22.41 , 22.57 , 22.96 , 22.94 , 22.62 , 22.62 , 22.56 , 22.46 , 22.29 , 22.05 , 22.06 , 22.04 , 22.02 , 22.03 , 22.11 , 19.54 , 23.15 , 22.21 , 21.45 , 21.33 , 21.73 , 21.85 , 21.47 , 21.60 , 21.97 , 23.98 , 27.51 , 27.82 , 27.18 , 27.16 , 26.82 , 26.50 , 26.37 , 25.84 , 25.81 , 25.42 , 25.21 , 25.15 , 25.17 , 21.42 , 27.67 , 24.75 , 24.36 , 24.63 , 24.99 , 25.15 , 25.02 , 24.75 , 24.41 , 24.31 , 24.51 , 24.49 , 24.51 , 24.21 , 23.85 , 23.86 , 23.86 , 23.86 , 23.86 , 18.49 , 24.55 , 23.54 , 22.65 , 23.62 , 25.00 , 24.52 , 23.93 , 23.89 , 22.88 , 24.45 , 24.65 , 23.88 , 23.47 , 23.28 , 23.24 , 23.22 , 23.01 , 22.65 , 22.59 , 22.58 , 22.59 , 22.49 , 21.99 , 21.95 , 21.96 , 20.26 , 17.84 , 22.43 , 24.31 , 22.68 , 21.82 , 18.18 , 19.64 , 20.35 , 23.65 , 22.04 , 21.33 , 22.70 , 23.23 , 22.83 , 21.44 , 25.11 , 25.30 , 25.45725402 , 25.61718544 , 25.77711686 , 25.93704828 , 26.09697971 , 26.25691113 , 26.41684255 , 26.57677397 , 26.73670539 , 26.89663681 , 27.05656823 , 27.21649966 , 27.37643108 , 27.5363625 , 27.69629392 , 27.85622534 , 28.01615676 , 28.17608818 , 28.33601961 , 28.49595103 , 28.65588245 , 28.81581387 , 28.97574529 , 29.13567671 , 29.29560814 , 29.45553956 , 29.61547098 , 29.7754024 , 29.93533382 , 30.09526524 , 30.25519666 , 30.41512809 , 30.57505951 , 30.73499093 , 30.89492235 , 31.05485377 , 31.21478519 , 31.37471661 , 31.53464804 , 31.69457946 , 31.85451088 , 32.0144423 , 32.17437372 , 32.33430514 , 32.49423657 , 32.65416799 , 32.81409941 , 32.97403083 , 33.13396225 , 33.29389367 , 33.45382509 , 33.61375652 , 33.77368794 , 33.93361936 , 34.09355078 , 34.2534822 , 34.41341362 , 34.57334504 , 34.73327647 , 34.89320789 , 35.05313931 , 35.21307073 , 35.37300215 , 35.53293357 , 35.692865 , 35.85279642 , 36.01272784 , 36.17265926 , 36.33259068 , 36.4925221 , 36.65245352 , 36.65 , 37.80 , 39.31 , 39.04 , 38.86 , 38.87 , 38.84 , 38.73 , 41.26 , 41.86 , 38.69 , 38.28 , 37.88 , 35.06 , 39.69 , 37.22 , 36.58 , 36.23 , 36.23 , 36.21 , 36.22 , 36.00 , 35.75 , 35.77 , 35.44 , 35.38 , 35.36 , 35.30 , 35.24 , 34.86 , 34.69 , 34.66 , 35.10 , 32.32 , 37.89 , 34.86 , 34.22 , 33.83 , 33.70 , 33.51 , 33.47 , 32.88 , 32.87 , 32.74 , 32.21 , 32.88 , 32.86 , 32.59 , 32.09 , 31.98893886 , 31.88425262 , 31.77956638 , 31.67488015 , 31.57019391 , 31.46550767 , 31.36082143 , 31.2561352 , 31.15144896 , 31.04676272 , 30.94207648 , 30.83739025 , 30.73270401 , 30.62801777 , 30.52333153 , 30.4186453 , 30.31395906 , 30.20927282 , 30.10458658 , 29.99990035 , 29.89521411 , 29.79052787 , 29.68584163 , 29.69 , 29.68 , 29.70 , 29.33 , 29.05 , 28.96 , 28.95 , 28.93 , 27.08 , 29.78 , 31.15 , 29.33 , 28.88 , 28.11 , 28.38 , 28.18 , 25.81 , 29.13 , 27.52 , 27.85 , 28.08 , 27.79 , 27.48 , 27.44 , 27.51 , 27.43168911 , 27.35580402 , 27.27991892 , 27.20403382 , 27.12814872 , 27.05226362 , 26.97637853 , 26.90049343 , 26.82460833 , 26.74872323 , 26.67283813 , 26.59695304 , 26.52106794 , 26.44518284 , 26.36929774 , 26.29341264 , 26.21752755 , 26.14164245 , 26.06575735 , 25.98987225 , 25.91398715 , 25.83810206 , 25.76221696 , 25.68633186 , 25.61044676 , 25.53456166 , 25.45867657 , 25.38279147 , 25.30690637 , 25.23102127 , 25.15513617 , 25.07925108 , 25.00336598 , 24.92748088 , 24.85159578 , 24.77571068 , 24.69982559 , 24.62394049 , 24.54805539 , 24.47217029 , 24.39628519 , 24.3204001 , 24.244515 , 24.1686299 , 24.0927448 , 24.0168597 , 23.94097461 , 23.86508951 , 23.78920441 , 23.71331931 , 23.63743421 , 23.56154912 , 23.48566402 , 23.40977892 , 23.33389382 , 23.25800872 , 23.18212363 , 23.10623853 , 23.03035343 , 22.95446833 , 22.87858323 , 22.80269814 , 22.72681304 , 22.65092794 , 22.57504284 , 22.49915774 , 22.42327265 , 22.34738755 , 22.27150245 , 22.19561735 , 22.11973225 , 22.04384716 , 21.96796206 , 21.89207696 , 21.81619186 , 21.74030676 , 21.66442167 , 21.58853657 , 21.51265147 , 21.43676637 , 21.36088127 , 21.28499618 , 21.20911108 , 21.13322598 , 21.05734088 , 20.98145578 , 20.90557069 , 20.82968559 , 20.75380049 , 20.67791539 , 20.60203029 , 20.5261452 , 20.4502601 , 20.374375 , 20.2984899 , 20.2226048 , 20.14671971 , 20.07083461 , 19.99494951 , 19.91906441 , 19.84317931 , 19.76729422 , 19.69140912 , 19.61552402 , 19.53963892 , 19.46375382 , 19.38786873 , 19.31198363 , 19.23609853 , 19.16021343 , 19.08432833 , 19.00844324 , 18.93255814 , 18.85667304 , 18.78078794 , 18.70490284 , 18.62901775 , 18.55313265 , 18.47724755 , 18.48 , 21.74 , 20.75 , 20.63 , 19.94 , 20.13 , 20.72 , 20.69 , 20.61 , 20.31 , 19.96 , 19.17 , 19.55 , 19.66 , 19.56 , 19.57 , 19.56 , 19.59 , 19.71 , 19.78 , 19.56 , 19.56 , 19.56 , 19.74 , 19.52 , 19.46615616 , 19.41036148 , 19.3545668 , 19.29877211 , 19.24297743 , 19.18718275 , 19.13138807 , 19.07559339 , 19.01979871 , 18.96400403 , 18.90820935 , 18.85241466 , 18.79661998 , 18.7408253 , 18.68503062 , 18.62923594 , 18.57344126 , 18.51764658 , 18.4618519 , 18.40605722 , 18.35026253 , 18.29446785 , 18.23867317 , 18.24 , 18.33 , 18.27 , 18.35 , 18.33 , 18.41 , 18.35 , 18.13 , 18.24 , 18.02 , 17.77 , 17.59 , 17.75 , 15.10 , 10.14 , 6.62 , 16.32 , 16.49 , 14.37 , 17.33 , 17.36 , 17.98 , 19.44 , 19.53 , 19.02 , 19.02 , 18.76 , 18.49 , 18.49 , 18.48 , 14.63 , 13.92 , 14.06 , 14.31 , 16.21 , 17.23 , 17.85 , 18.29 , 18.62 , 17.88 , 15.23 , 14.94 , 16.00 , 16.48 , 16.56 , 16.41 , 16.42 , 16.52 , 16.48 , 16.45115191 , 16.42207613 , 16.39300034 , 16.36392456 , 16.33484878 , 16.305773 , 16.27669722 , 16.24762144 , 16.21854565 , 16.18946987 , 16.16039409 , 16.13131831 , 16.10224253 , 16.07316675 , 16.04409096 , 16.01501518 , 15.9859394 , 15.95686362 , 15.92778784 , 15.89871206 , 15.86963628 , 15.84056049 , 15.81148471 , 15.78240893 , 15.75333315 , 15.72425737 , 15.69518159 , 15.6661058 , 15.63703002 , 15.60795424 , 15.57887846 , 15.54980268 , 15.5207269 , 15.49165111 , 15.46257533 , 15.43349955 , 15.40442377 , 15.37534799 , 15.34627221 , 15.31719642 , 15.28812064 , 15.25904486 , 15.22996908 , 15.2008933 , 15.17181752 , 15.14274174 , 15.11366595 , 15.11 , 15.08 , 15.05 , 14.54 , 14.16 , 13.85 , 13.84 , 13.84 , 13.87 , 13.84 , 14.16 , 14.45 , 14.18 , 13.82 , 12.88 , 12.49 , 12.52 , 12.60 , 11.25 , 8.45 , 17.19 , 17.18 , 16.23 , 14.84 , 11.67 , 11.36 , 13.70 , 14.80 , 12.94 , 13.23 , 13.94 , 13.54 , 14.66 , 15.03 , 15.08 , 15.24 , 14.68 , 14.11 , 12.89 , 11.35 , 5.48 , 7.58 , 19.03 , 19.56 , 16.20 , 14.07 , 13.19 , 13.05 , 12.77 , 12.74748637 , 12.72282914 , 12.6981719 , 12.67351466 , 12.64885743 , 12.62420019 , 12.59954295 , 12.57488572 , 12.55022848 , 12.52557124 , 12.50091401 , 12.47625677 , 12.45159953 , 12.4269423 , 12.40228506 , 12.37762782 , 12.35297059 , 12.32831335 , 12.30365612 , 12.27899888 , 12.25434164 , 12.22968441 , 12.20502717 , 12.21 , 12.20 , 12.22 , 12.21 , 12.23 , 12.22 , 12.39 , 12.56 , 12.69 , 12.62 , 10.52 , 8.42 , 11.62 , 11.30 , 11.33 , 11.36 , 11.46 , 11.31 , 11.32 , 11.33 , 11.33 , 11.51 , 11.49 , 11.41 , 11.34 , 11.33 , 11.32 , 11.33 , 11.35 , 11.72 , 12.08 , 12.21 , 12.30 , 12.48 , 12.12 , 10.93 , 6.45 , 9.65 , 12.24 , 11.32 , 7.05 , 12.25 , 13.12 , 13.60 , 13.43 , 12.91 , 12.77 , 12.82 , 13.10 , 13.00 , 12.92 , 12.85 , 11.54 , 7.26 , 5.28 , 6.96 , 8.09 , 7.51 , 10.27 , 12.03 , 12.16 , 12.01 , 12.14 , 12.21 , 12.19 , 12.26 , 12.07 , 12.20 , 12.22 , 12.19 , 12.19 , 12.19 , 11.93 , 11.31 , 11.24 , 7.99 , 5.54 , 7.21 , 7.77 , 8.54 , 11.38 , 12.02 , 12.39 , 12.26 , 12.43 , 12.33 , 12.12 , 12.17 , 11.38 , 7.39 , 7.21 , 11.92 , 12.51 , 12.75 , 13.04 , 12.33 , 11.36 , 11.26 , 9.93 , 5.18 , 5.20 , 7.56 , 10.21 , 11.58 , 12.86 , 14.01 , 14.56 , 14.96 , 16.35 , 17.63 , 19.26 , 21.42 , 21.17 , 20.11 , 19.22 , 18.48 , 17.90 , 17.92 , 18.17 , 18.49 , 18.95 , 18.98 , 18.98 , 19.00 , 18.99 , 18.78 , 18.42 , 18.39 , 17.70 , 18.17 , 18.12 , 17.49 , 18.06 , 18.82 , 19.05 , 21.32 , 22.21 , 20.42 , 23.01 , 26.42 , 29.05 , 31.32 , 32.94 , 35.35 , 37.09 , 36.79741232 , 36.50579111 , 36.21416991 , 35.9225487 , 35.6309275 , 35.33930629 , 35.04768508 , 34.75606388 , 34.46444267 , 34.17282147 , 33.88120026 , 33.58957905 , 33.29795785 , 33.00633664 , 32.71471543 , 32.42309423 , 32.13147302 , 31.83985182 , 31.54823061 , 31.2566094 , 30.9649882 , 30.67336699 , 30.38174579 , 30.38 , 29.57 , 29.19 , 29.00 , 28.59 , 27.96 , 27.54 , 27.89 , 27.44 , 27.03 , 26.56818429 , 26.11105616 , 25.65392802 , 25.19679988 , 24.73967174 , 24.74 , 24.60 , 24.60 , 24.62 , 24.57 , 24.15 , 24.45 , 24.12 , 24.00 , 23.94 , 23.92 , 23.72 , 23.45 , 23.26 , 23.17 , 23.22 , 23.24 , 22.90 , 22.38 , 24.07 , 23.23 , 23.24 , 23.84 , 23.90 , 22.95 , 22.77 , 25.07 , 25.37 , 25.71 , 25.56 , 26.53 , 26.95 , 27.90 , 28.16 , 29.17039508 , 30.17833769 , 31.1862803 , 32.19422292 , 33.20216553 , 34.21010814 , 35.21805075 , 36.22599336 , 37.23393598 , 38.24187859 , 39.2498212 , 40.25776381 , 41.26570642 , 42.27364904 , 43.28159165 , 44.28953426 , 45.29747687 , 46.30541948 , 47.3133621 , 48.32130471 , 49.32924732 , 50.33718993 , 51.34513254 , 51.35 , 51.11 , 50.35 , 49.66 , 49.11 , 48.25 , 48.05 , 47.35 , 45.04 , 48.39 , 44.40 , 45.32 , 44.56 , 44.40 , 43.96 , 43.47 , 41.47 , 44.00 , 42.14 , 41.41 , 41.60 , 41.77 , 41.27 , 40.49 , 40.65 , 40.42 , 39.94 , 39.71 , 39.73 , 39.39 , 39.03 , 38.87 , 36.95 , 41.40 , 37.02 , 37.72 , 37.32 , 38.18 , 37.40 , 37.21 , 37.09 , 36.98 , 36.90 , 36.39 , 36.57 , 36.41 , 36.26 , 36.22 , 36.34 , 36.19180963 , 36.03970061 , 35.8875916 , 35.73548258 , 35.58337357 , 35.43126455 , 35.27915554 , 35.12704652 , 34.97493751 , 34.82282849 , 34.67071948 , 34.51861046 , 34.36650145 , 34.21439243 , 34.06228342 , 33.9101744 , 33.75806539 , 33.60595638 , 33.45384736 , 33.30173835 , 33.14962933 , 32.99752032 , 32.8454113 , 32.85 , 32.87 , 32.84 , 32.55 , 32.10 , 28.43 , 33.70 , 33.32 , 28.84 , 25.63 , 28.74 , 31.95 , 31.91 , 26.63 , 18.41 , 33.06 , 49.15 , 42.26 , 45.79 , 43.06 , 39.07 , 37.04 , 36.05 , 35.36 , 35.34 , 35.41018281 , 35.48386199 , 35.55754117 , 35.63122034 , 35.70489952 , 35.77857869 , 35.85225787 , 35.92593704 , 35.99961622 , 36.0732954 , 36.14697457 , 36.22065375 , 36.29433292 , 36.3680121 , 36.44169127 , 36.51537045 , 36.58904962 , 36.6627288 , 36.73640798 , 36.81008715 , 36.88376633 , 36.9574455 , 37.03112468 , 37.03 , 36.62 , 36.22 , 36.22 , 35.90 , 35.34 , 35.36 , 35.31 , 32.28 , 37.01 , 33.57 , 29.27 , 28.85 , 32.03 , 31.45 , 30.81 , 31.23 , 35.12 , 34.21 , 32.85 , 31.05 , 28.42 , 32.56 , 31.61 , 30.78 , 30.23 , 29.94 , 29.89 , 29.87 , 29.84 , 29.58 , 29.39 , 29.51 , 29.05 , 28.06 , 22.53 , 25.26 , 31.53 , 31.80 , 36.39 , 38.36 , 33.63 , 33.69 , 32.76 , 32.17 , 32.05 , 31.97 , 31.56 , 32.15 , 31.96527699 , 31.77675314 , 31.5882293 , 31.39970545 , 31.21118161 , 31.02265776 , 30.83413392 , 30.64561007 , 30.45708623 , 30.26856238 , 30.08003854 , 29.89151469 , 29.70299085 , 29.514467 , 29.32594316 , 29.13741931 , 28.94889547 , 28.76037162 , 28.57184778 , 28.38332393 , 28.19480009 , 28.00627624 , 27.8177524 , 27.82 , 27.65 , 27.49 , 27.48 , 27.45 , 27.46 , 27.35 , 27.13 , 26.97 , 27.34 , 27.30 , 27.32 , 27.26 , 26.75 , 25.89 , 26.64 , 26.58 , 26.02 , 26.03 , 25.92 , 25.62 , 25.47 , 25.32 , 25.02 , 25.28 , 25.19521191 , 25.11499337 , 25.03477483 , 24.95455629 , 24.87433776 , 24.79411922 , 24.71390068 , 24.63368214 , 24.5534636 , 24.47324506 , 24.39302652 , 24.31280799 , 24.23258945 , 24.15237091 , 24.07215237 , 23.99193383 , 23.91171529 , 23.83149676 , 23.75127822 , 23.67105968 , 23.59084114 , 23.5106226 , 23.43040406 , 23.43 , 23.36 , 23.32 , 23.34 , 23.31 , 23.32 , 23.28 , 23.30 , 23.33 , 23.83 , 24.08 , 21.22 , 26.23 , 23.63 , 20.95 , 25.45 , 21.96 , 22.69 , 23.10 , 22.74 , 22.64 , 22.62 , 22.58 , 22.40 , 22.01 , 22.01 , 22.01 , 22.01 , 22.01 , 21.94 , 21.83 , 22.03 , 22.28 , 22.57 , 22.57 , 22.00 , 21.94 , 22.18 , 20.12 , 14.03 , 18.45 , 24.73 , 24.03 , 22.54 , 22.64 , 22.12 , 21.64 , 21.38 , 21.];

for i=1:length(Q)
  Q(i)=max(Q(i),0.46);
end

integral_vazao=sum(Q);
%Filtro passa baixas para o vetor de vazão
Delta=1.5*std(Q);
for i=2:length(Q)-1
  if ((abs((Q(i)-Q(i-1)))>Delta)&&(abs((Q(i)-Q(i+1)))>Delta))
    Q(i)=(Q(i-1)+Q(i-2))*0.5;
    end  
  end
Q_mav=medfilt1(Q,7);
Q_mav(1:7)=Q(1:7);
Q=Q_mav;

diferenca_integral=(integral_vazao-sum(Q));
contador_divisao=0;
for i=1:length(Q)
  if (Q(i)>0.46)
    contador_divisao++;
    end
  end
for i=1:length(Q)
  if (Q(i)>0.46)
    Q(i)=Q(i)+diferenca_integral/contador_divisao;
    end
  end
##for i=1:length(Q)
##  if i<3
##    Q_nova(i)=Q(i);
##    else
##    Q_nova(i)=1*Q(i)+*Q(i-1)+0.0009447*Q(i-2)+1.911*Q(i-1)-0.915*Q(i-2);
##   end 
##end
%Nv inicial do Reservatorio
h0=643.11;

%Nv jusante 0
%hjusante=608.03;
hjusante=607.60;

%ctes
%Perdas na Linha e SA e TE
pe=2.7/100;

%Vazao Nominal
Qn=8.7;

%Vazao de Corte
Qc=Qn*0.4;

%Perdas Hidraulicas 1.93
ph=1.25/100;

%Peso Especifico Agua
pea=998;

%Aceleracao da Gravidade
g=9.8;

%Equacao de Rendimento da Turbina
rt=[-0.0079874,     0.3629358,    -6.9174895,    71.5250765,  -432.1130993,  1519.1633749, -2854.6595054,  2260.2185837 ];

%Equacao de Rendimento do Gerador
rg=[-0.76800, 3.52000, 92.90000];


%Constante do vertedouro
C0=2.11;

%Largura do vertedouro
Lv=45;

%Equação C/C0
Pc_c0=[ 0.096006, -0.27062, 0.386699, 0.783742];

%Nv Min Reservatorio
hmin=643;

%Nv vertimento
hmax=643.50;

%Vazao Sanitaria
Qs=0.46;

%condicao de uso de reservatorio
cond=0;

%Volume do reservatorio
volm=0.043e6;

%Eq. curva jusante Nv(defluente[m³/s]])
Pjus=[0.017857, 607.739286];

%Num de unidades geradoras na planta
nUG=2;

%%Inicializacao de Vetores
%Vazao Turbinavel
Qt=zeros(1,length(Q));

%Unidades em operacao
UG=zeros(1,length(Q));

%Nv reservatorio
h=zeros(1,length(Q)+1);
h(1)=h0;
vert=zeros(1,length(Q));

%P eixo turbina
Peixo=zeros(1,length(Q));

%P gerador
Pg=zeros(1,length(Q));

%Nv jusante
hj=zeros(1,length(Q));

%Vol reservatorio
vol=zeros(1,length(Q)+1);
vol(1)=(h0-hmax)*volm;

%Parametros de previsao para deplecionamento
  %calculo do tempo de esvaziamento do reservatorio
tesv=volm/((Qn*nUG)*60*60);
  
control=zeros(1,length(Q));
vexc=zeros(1,length(Q));
vcontrole=zeros(1,length(Q));
Qtcc=zeros(1,length(Q));
qv=zeros(1,length(Q));
vol_futuro=zeros(1,length(Q));
t_esv=zeros(1,length(Q));
volumefuturo=zeros(1,length(Q));

%A vazão sanitária é contínua
Q=Q-Qs;

# Determinar em que pontos a vazão é maior que a vazão máxima das máquinas
Verificacao=Q>(Qn*nUG);
# Criar um vetor contendo os pontos em que a vazão é maior que a vazão máxima, 
# assumindo 0 para outros pontos
vf=Verificacao.*Q;
for i=1:(length(Q)-2)
  if vf(length(vf)-i)!=0
     # caso tenhamos um valor de vazão afluente maior do que as máquinas podem 
     # turbinar, o volume excedente é sinalizado no índice anterior e o atual
     # é zerado
     # O volume futuro não deve ultrapassar o volume máximo do reservatório
     volumefuturo(length(vf)-i-1)= min(vf(length(vf)-i-1)+volumefuturo(length(vf)-i),volm/(60*60));
     volumefuturo(length(vf)-i)=0;
     end
end
volumefuturo(length(volumefuturo)-1)=volm;
Qtcc=Q;

for i=1:(length(Q))
  volumefuturo(i)=min(volm/(60*60),volumefuturo(i));
  vol_compensacao=min(max(volumefuturo(i), 0), 30*24*nUG*Qn);
  
  %if (vol_compensacao>0) vol_compensacao+=Q(i); end
  
  contador=0;
  while (vol_compensacao>0)&&(contador-i>0)
    # Se vol_compensacao < Engolimento máx - Vazão compensada
    if ((vol_compensacao-(nUG*Qn-Qtcc(i-contador)))<0)
      vol_compensacao=0; # sai do loop
      # Qtcc recebe o restante do volume à compensar
      Qtcc(i-contador)=vol_compensacao+Qtcc(i-contador);
    else
      vol_compensacao=vol_compensacao-(nUG*Qn-Qtcc(i-contador));
      Qtcc(i-contador)=nUG*Qn;
    end
    contador++;
    end
  end
figure
plot(Qtcc)  
%
for i=1:length(Q)
  %reset variaveis
  Qvert=0;
  
  %volume inicial do reservatório
  if (i==1)
      vol(i)=(hmax-h0/hmax)*volm; end
  
  if (vol(i)>0.9*volm)
    Qtc=Qtcc(i);
  else 
    Qtc=Q(i);
  end  
    
  %Corte 1 UG   <    Vazão Afluente    <=   Engolimento máx 1 UG -> 1 UG opera
  if(Qtc>=Qc)&&(Qtc<=Qn)
      %vazao afluente para 1 maq, 1 máq no sistema
      UG(i)=1;
      %Qvert=0;
      %Caso o reservatorio esteja deplecionado, e necessario voltar para o nv 
      %nominal
      if(vol(i)<volm)
        Qt(i)=0; %Nesse caso, a UG não opera
        UG(i)=0;
      else
        Qt(i)=Qtc;
      end
      
    %Corte 2 UGs  <    Vazão Afluente    <=   Engolimento máx 2 UGs -> 2 UGs operam
    else if (Qtc>Qn)&&(Qtc<=2*Qn)
      %vazao afluente para 2 maqs
      Qt(i)=Qtc*0.5;
      UG(i)=2;
      %Qvert=0;
      
    %Vazão Afluente    >   Engolimento máx 2 UGs -> 2 UGs operam  
    else if (Qtc>2*Qn)
      %vazao afluente para mais que 2 maqs
      Qt(i)=Qn;
      UG(i)=2;

    %Vazão Afluente    <   Vazão de corte 1 UG
    else if(Qtc<Qc)
      %vazao afluente menor do que para 1 maq
      if((vol(i)>=Qc*60*60)&&(cond==0))
        %uso do reservatorio para continuar geracao em potência máxima possível
        %otimizando o rendimento, já que a água não é despercidaça
        Qt(i)=min(Qtc+vol(i)/(60*60),nUG*Qn);
        if (Qt(i)>Qn)
          UG(i)=2;
          Qt(i)=Qt(i)/2;
        else 
          UG(i)=1;
          end
        %Qvert=0;
      else
        %reestabelecimento do reservatorio
        Qt(i)=0;
        UG(i)=0;
        cond=1;
        %Qvert=0;
      end  
    end
    end
    end
    end
  
    
    vol(i+1)=vol(i)+(Q(i)-Qt(i)*UG(i))*60*60;
    
    %verificacao se o reservatorio nao esta acima do nv de vertimento
    if(vol(i+1)>volm)
      vol(i+1)=volm;
      %Calculo nv montante
      h(i+1)=hmax+((Qvert)/((1.66+0.0017336*(Qvert))*110))^(2/3);
      %h(i+1)=hmax-0.15;
    else
      %Calculo nv montante
      h(i+1)=(hmax-hmin)*vol(i+1)/volm+hmin;
    end
    
    if(cond==1)&&(vol(i+1)>=volm*1)
      cond=0;
    end
    
    %Verificação se o reservatório está em nível mínimo.
    if((vol(i+1)<0)||(vol(i)<0))
      vol(i+1)=max(vol(i+1),0);
      vol(i)=max(vol(i),0);
    end
    
    %calculo nv jusante
    %hj(i)=polyval(Pjus,Qvert+Qt(i)*UG(i)+Qs); %essa eq nao funciona bem para altas
    %vazoes
    hj(i)=hjusante;
    
    %Potencia no Eixo
    Peixo(i)=1e-6*(h(i+1)-hj(i))*Qt(i)*g*pea*polyval(rt,Qt(i))/100;
    
    %Potencia Geradores
    Pg(i)=Peixo(i)*polyval(rg,Peixo(i))*UG(i)*10/1000;
    
    %Potência Líquida
    Pl(i)=Pg(i)-pe*1e-6;
    
    if (vol(i)>=volm) qv(i)=max(Q(i)-Qt(i)*UG(i),0); end
    
end
Peixo=Peixo.*UG;
Qt=Qt.*UG;

##%% -- GRÁFICO 1
figure
subplot(3,1,1)
plot(Peixo)
hold on
plot(Pg)
grid on;
title('Potências')
xlabel('Horas')
ylabel('Potência (MW)')
legend('Peixo','Potencia Gerador')
##
subplot(3,1,2)
plot(Qt)
hold on
plot(Q)
grid on;
title('Vazões')
xlabel('Horas')
ylabel('Vazão (m^3/s)')
legend('Vazão Turbinada','Vazão Afluente')
##
subplot(3,1,3)
plot(h)
hold on;
plot(hmax*ones(size(h)),'r');
hold on;
plot(hmin*ones(size(h)),'r');
grid on;
title('Nível do Reservatório')
xlabel('Horas')
ylabel('N.A. (m)')
##
##
##%% -- GRÁFICO 2
figure
subplot(3,1,1)
plot(Qt)
hold on
plot(Q)
grid on;
title('Vazões')
xlabel('Horas')
ylabel('Vazão (m^3/s)')
legend('Vazão Turbinada','Vazão Afluente')

subplot(3,1,2)
plot(h)
hold on;
plot(hmax*ones(size(h)),'r');
hold on;
plot(hmin*ones(size(h)),'r');
grid on;
title('Nível do Reservatório')
xlabel('Horas')
ylabel('N.A. (m)')

subplot(3,1,3)
plot(qv)
grid on;
title('Vazão vertida')
xlabel('Horas')
ylabel('Vazão (m^3/s)')


figure
plot(Qtcc)
hold on
plot(Q)
legend('Qtcc ()','Q(afluente)')

sum(Pg)
sum(Pl)
